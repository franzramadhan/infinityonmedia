<!DOCTYPE html>
<html>
<head lang="en">
    <title></title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta charset="utf-8">


    <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
    <link rel="stylesheet" href="assets/css/jquery.mobile-1.4.3.min.css" />
    <script src="assets/js/jquery-1.11.1.min.js"></script>
    <script src="assets/js/jquery.mobile-1.4.3.min.js"></script>
    <script>

        var regex = new Array(),
                it;

        var allInputs = $( ":input" );

        function clean_it(it) {
            regex[0] = /\./ig;
            regex[1] = /\,/ig;
            it = it.replace(regex[0], "");
            it = it.replace(regex[1], "");
            return it;
        }

        var num, LNum, x, fnum, snums, snumx, snumsr, snumr;
        //Fungsi convert dari clean to number format
        function rubah(num) {
            num = String(num);
            LNum = num.length;
            if (LNum > 3) {
                fnum = parseInt(LNum / 3, 10);
                if ((LNum % 3) === 0) {
                    fnum--;
                }
                regex[2] = /(.+)(\d{3}$)/ig;
                for (x = 1; x <= fnum; x++) {
                    if (x == 1) {
                        snums = num.replace(regex[2], "$2");
                        snumx = num.replace(regex[2], "$1");
                        snumsr = "." + snums;
                    } else {
                        snums = snumx.replace(regex[2], "$2");
                        snumx = snumx.replace(regex[2], "$1");
                        snumsr = "." + snums + snumsr;
                    }
                }
                snumr = snumx + snumsr;
            } else {
                snumr = num;
            }
            return snumr;
        }

        var b, toformat;
        //Fungsi clean and format number
        function formated(b) {
            toformat = document.form1.elements[b].value;
            toformat = clean_it(toformat);
            toformat = parseInt(toformat, 10);
            toformat = rubah(toformat);
            document.form1.elements[b].value = toformat;
        }


        $( document ).on( "pageinit", "#calc", function( event ) {
            // Fungsi untuk nisab penghasilan
            function hitung_nisab() {
                var gaji_perbulan = $('#gaji').val();
                var penghasilan_lain = $('#gaji_tambahan').val();
                var hutang = $('#kebutuhan').val();

                pendapatan = parseInt(gaji_perbulan) + parseInt(penghasilan_lain) - parseInt(hutang);
                besar_nishab = parseInt(522 * 6500);

                if (pendapatan > besar_nishab) {
                    $('#wajib').text('WAJIB');
                    jumlah_wajib_zakat = parseInt(0.025 * pendapatan);
                } else {
                    $('#wajib').text('TIDAK');
                    jumlah_wajib_zakat = parseInt(0);
                }

                $('#jml_zakat_penghasilan').text(jumlah_wajib_zakat);
            }

            $('#gaji, #gaji_tambahan, #kebutuhan').keyup(function () {
                hitung_nisab();
            });

            //Jquery kalkulator
            //Fungsi untuk membersihkan (.)

            //Jquery for kalkulator
            $('#gaji, #gaji_tambahan, #kebutuhan, #hrg_beras, #hrg_emas, #hutang_tempo , .sum_maal').keyup(function () {

                //Perhitungan Zakat penghasilan
                gaji_saya = $('#gaji').val();
                penghasilan_lain = $('#gaji_tambahan').val();
                hutang =  $('#kebutuhan').val();

                c_gaji_saya = clean_it(gaji_saya);
                c_penghasilan_lain = clean_it(penghasilan_lain);
                c_hutang = clean_it(hutang);

                total1 = parseInt(c_gaji_saya) + parseInt(c_penghasilan_lain) - parseInt(c_hutang);
                total2 = rubah(total1);
                $('#penghasilan').val(total2);

                //Perhitungan nisab zakat penghasilan
                harga_beras = $('#hrg_beras').val();
                c_gaji_saya = clean_it(harga_beras);
                besar_nishab = parseInt(522 * c_gaji_saya);
                c_besar_nishab = rubah(besar_nishab);
                $('#nisab_zakat_penghasilan').val(c_besar_nishab);

                if (besar_nishab < total1) {
                    $('#wajib').val('YA');
                    jumlah_wajib_zakat = parseInt(0.025 * total1);
                    c_jumlah_wajib_zakat = rubah(jumlah_wajib_zakat);
                } else {
                    $('#wajib').val('TIDAK');
                    jumlah_wajib_zakat = parseInt(0);
                    c_jumlah_wajib_zakat = jumlah_wajib_zakat;
                }
                $('#jml_zakat_penghasilan').val(c_jumlah_wajib_zakat);
                $('#zakat_perbulan').val(c_jumlah_wajib_zakat);

                //Perhitungan Zakat Maal
                var total = 0;
                $(".sum_maal").each(function () {
                    total += parseInt(clean_it($(this).val()));
                });
                c_total = rubah(total);
                $('#jml_harta').val(c_total);

                hutang_tempo = $('#hutang_tempo').val();
                c_hutang_tempo = clean_it(hutang_tempo);
                jumlah_zakat_harta = total - c_hutang_tempo;
                c_jumlah_zakat_harta = rubah(jumlah_zakat_harta);
                $('#jml_harta_zakat').val(c_jumlah_zakat_harta);
                //End Perhitungan Zakat Maal

                //Perhitungan bayar Zakat Maal
                //----------------------------
                harga_emas = $('#hrg_emas').val();
                c_harga_emas = clean_it(harga_emas);
                nisab_maal_pertahun = parseInt(85 * c_harga_emas);
                c_nisab_maal_pertahun = rubah(nisab_maal_pertahun);
                $('#nisab_zakat_maal').val(c_nisab_maal_pertahun);

                if (nisab_maal_pertahun < jumlah_zakat_harta) {
                    wajib_bayar_maal = 'YA';
                    var wajib_bayar_maal_pertahun = parseInt(0.025 * total);
                    var wajib_bayar_maal_perbulan = parseInt(wajib_bayar_maal_pertahun / 12);
                } else {
                    wajib_bayar_maal = 'TIDAK';
                    wajib_bayar_maal_pertahun = parseInt('0');
                    wajib_bayar_maal_perbulan = parseInt('0');
                }
                $('#wajib_maal').val(wajib_bayar_maal);
                $('#jml_zakat_maal_thn').val(rubah(wajib_bayar_maal_pertahun));
                $('#jml_zakat_maal_bln').val(rubah(wajib_bayar_maal_perbulan));
                $('#zakat_maal_perbulan').val(rubah(wajib_bayar_maal_perbulan));

                //RESUME
                total_zakat_perbulan = jumlah_wajib_zakat + wajib_bayar_maal_perbulan;
                c_total_zakat_perbulan = rubah(total_zakat_perbulan);
                $('#total_zakat_perbulan').val(c_total_zakat_perbulan);

            });
            //End jquery kalkulator

            //set null and default value

            $('#gaji, #hutang_tempo, #hrg_emas, #hrg_beras, #kebutuhan, #gaji_tambahan, #harta_antik, #harta_kendaraan, #harta_lain, #harta_logam, #harta_piutang, #harta_stok, #harta_properti, #harta_surat, #harta_tabungan').focus(function(){
                if ($(this).val() == $(this)[0].defaultValue) {
                    $(this).val('');
                }
            });

            $('#gaji, #hutang_tempo, #hrg_emas, #hrg_beras, #kebutuhan, #gaji_tambahan, #harta_antik, #harta_kendaraan, #harta_lain, #harta_logam, #harta_piutang, #harta_stok, #harta_properti, #harta_surat, #harta_tabungan').blur(function(){
                if ($(this).val() == '') {
                    $(this).val($(this)[0].defaultValue);
                }
            });

        });



    </script>
    <style>
        body {
            background: url(assets/images/bg.png) repeat fixed;
            background-size:auto;
        }

        .ui-content, .ui-btn {
            background: transparent;
        }
    </style>
</head>
<body>
<!--donatur-->

<div id="donate" data-role="page" class="jqm-demos ui-responsive-panel">
    <div data-role="header">
        <h1>Layanan Donatur</h1>
        <a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
    </div>
    <div role="main" class="ui-content jqm-content jqm-fullwidth">
        <form action="#">
            <div>
                <label for="nama_lengkap">Nama Lengkap</label>
                <input type="text" name="nama_lengkap" id="nama_lengkap"/>
            </div>
            <div>
                <label for="alamat">Alamat</label>
                <textarea name="alamat" id="alamat" cols="30" rows="10"></textarea>
            </div>
            <div>
                <label for="kota">Kota</label>
                <select name="kota" id="kota">
                    <option value="">---</option><option value="Banda Aceh">Banda Aceh</option><option value="Medan">Medan</option><option value="Bandar Lampung">Bandar Lampung</option><option value="Palembang">Palembang</option><option value="Bengkulu">Bengkulu</option><option value="DKI Jakarta">DKI Jakarta</option><option value="Bandung">Bandung</option><option value="DI Yogyakarta">DI Yogyakarta</option><option value="Semarang">Semarang</option><option value="Surabaya">Surabaya</option><option value="Denpasar">Denpasar</option><option value="Makassar">Makassar</option><option value="Palu">Palu</option><option value="Mamuju">Mamuju</option><option value="Manado">Manado</option><option value="Kendari">Kendari</option><option value="Kupang">Kupang</option><option value="Mataram">Mataram</option><option value="Jayapura">Jayapura</option><option value="Kota Lain">Kota Lain</option>
                </select>
            </div>
            <div>
                <label for="telp">Telepon/HP</label>
                <input type="text" name="telp" id="telp"/>
            </div>
            <div>
                <label for="email">Email</label>
                <input type="email" name="email" id="email"/>
            </div>
            <div>
                <label for="donasi">Jumlah Donasi</label>
                <input type="text" name="donasi" id="donasi"/>
            </div>
            <div>
                <label for="label">Transfer Via</label>
                <label for="trf_via"><input type="radio" name="trf_via" id="trf_via" value="setor_tunai"/> Setor Tunai</label>
                <label for="trf_via"><input type="radio" name="trf_via" id="trf_via" value="auto_debt" />Auto Debit</label>
                <label for="trf_via"><input type="radio" name="trf_via" id="trf_via" value="atm" />ATM</label>
                <label for="trf_via"><input type="radio" name="trf_via" id="trf_via" value="ebank" />E-Banking</label>
            </div>
            <div>
                <label for="program">Program</label>
                <select name="program" class="wpcf7-form-control wpcf7-select wpcf7-validates-as-required form-control" id="program" aria-required="true" aria-invalid="false"><option value="Untuk Zakat">Untuk Zakat</option><option value="Untuk Infaq">Untuk Infaq</option><option value="Untuk Wakaf">Untuk Wakaf</option><option value="Untuk Qurban">Untuk Qurban</option></select>
            </div>
            <div>
                <select name="menu-zakat" class="wpcf7-form-control wpcf7-select form-control" id="menu-zakat" aria-invalid="false"><option value="">---</option><option value="BNI 8924.912">BNI 8924.912</option><option value="BRI SYARIAH 1004.088.267">BRI SYARIAH 1004.088.267</option><option value="BSM 700.611.3413">BSM 700.611.3413</option><option value="CIMB NIAGA SYARIAH 5200.100.117.001">CIMB NIAGA SYARIAH 5200.100.117.001</option><option value="DKI SYARIAH 7047.000.656">DKI SYARIAH 7047.000.656</option><option value="MANDIRI 006.000.1162.753">MANDIRI 006.000.1162.753</option><option value="MUAMALAT 305.00.238.15">MUAMALAT 305.00.238.15</option><option value="PERMATABANK SYARIAH 971.000.635">PERMATABANK SYARIAH 971.000.635</option></select>
            </div>
            <div>
                <fieldset class="ui-grid-a">
                    <label for="">Tanggal Transfer</label>
                    <div class="ui-block-a" style="width: 33%"><select name="tanggal"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option></select>
                    </div>
                    <div class="ui-block-b" style="width: 33%"><select name="bulan"><option value="Januari">Januari</option><option value="Februari">Februari</option><option value="Maret">Maret</option><option value="April">April</option><option value="Mei">Mei</option><option value="Juni">Juni</option><option value="Juli">Juli</option><option value="Agustus">Agustus</option><option value="September">September</option><option value="Oktober">Oktober</option><option value="November">November</option><option value="Desember">Desember</option></select></div>
                    <div class="ui-block-c" style="width: 33%"><select name="tahun"><option value="2013">2013</option><option value="2014">2014</option><option value="2015">2015</option></select></div>
                </fieldset>
            </div>
            <div>
                <label for="bukti_trf">Bukti Transfer</label>
                <input type="file" name="bukti_trf"/>
            </div>
            <div>
                <label for="keterangan">Keterangan</label>
                <input type="text" name="keterangan"/>
            </div>
            <div>
                <label for="keyword">Kata Kunci</label>
                <input type="text" name="keyword"/>
            </div>
            <div>
                <input type="submit" value="kirim"/>
            </div>
        </form>
    </div>
    <div data-role="panel" data-display="push" data-theme="b" id="nav-panel">
        <ul data-role="listview">
            <li data-icon="delete"><a href="#" data-rel="close">Close menu</a></li>
            <li><a href="index.html" data-transition="slide">Profil</a></li>
            <li><a href="news.html" data-transition="slide">Berita</a></li>
            <li><a href="zis.html" data-transition="slide">ZIS</a></li>
            <li><a href="qurban.html" data-transition="slide">Qurban</a></li>
            <li><a href="calc.html" data-transition="slide">Kalkulator Zakat</a></li>
            <li><a href="donasi.html" data-transition="slide">Layanan Donatur</a></li>
        </ul>
    </div><!-- /panel -->
</div>
</body>
</html>